<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Forgot Password</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      .auth-container {
        max-width: 400px;
        margin: 50px auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      .auth-link {
        text-decoration: none;
      }
      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="auth-container">
      <h2>Reset Password</h2>
      <p id="message" style="color: red"></p>

      <!-- Step 1: Enter email -->
      <form id="emailForm">
        <div class="mb-3">
          <input
            type="email"
            id="email"
            class="form-control"
            placeholder="Enter your email"
            required
          />
        </div>
        <button type="submit" class="btn btn-primary w-100">Send Code</button>
      </form>

      <!-- Step 2: Enter code -->
      <form id="codeForm" class="hidden">
        <div class="mb-3">
          <input
            type="text"
            id="codeInput"
            class="form-control"
            placeholder="Enter code"
            required
          />
        </div>
        <button type="submit" class="btn btn-primary w-100">Verify Code</button>
      </form>

      <!-- Step 3: New password -->
      <form id="newPasswordForm" class="hidden">
        <div class="mb-3">
          <input
            type="password"
            id="newPassword"
            class="form-control"
            placeholder="New Password"
            required
          />
        </div>
        <div class="mb-3">
          <input
            type="password"
            id="confirmNewPassword"
            class="form-control"
            placeholder="Confirm Password"
            required
          />
        </div>
        <button type="submit" class="btn btn-primary w-100">
          Change Password
        </button>
      </form>

      <p class="mt-3">
        <a href="login.html" class="auth-link">Back to Login</a>
      </p>
    </div>

    <script>
      const emailForm = document.getElementById("emailForm");
      const codeForm = document.getElementById("codeForm");
      const newPasswordForm = document.getElementById("newPasswordForm");
      const message = document.getElementById("message");

      let generatedCode = "";

      // Step 1: Enter email
      emailForm.addEventListener("submit", function (e) {
        e.preventDefault();
        const email = document.getElementById("email").value.trim();
        if (!email) {
          message.textContent = "Please enter your email.";
          return;
        }

        // Simulim i dërgimit të kodit
        generatedCode = Math.floor(100000 + Math.random() * 900000).toString(); // 6 shifra
        alert("Simulated email sent! Your code: " + generatedCode);

        emailForm.classList.add("hidden");
        codeForm.classList.remove("hidden");
        message.textContent = "";
      });

      // Step 2: Verify code
      codeForm.addEventListener("submit", function (e) {
        e.preventDefault();
        const codeInput = document.getElementById("codeInput").value.trim();
        if (codeInput === generatedCode) {
          codeForm.classList.add("hidden");
          newPasswordForm.classList.remove("hidden");
          message.textContent = "";
        } else {
          message.textContent = "Invalid code!";
        }
      });

      // Step 3: Change password
      newPasswordForm.addEventListener("submit", function (e) {
        e.preventDefault();
        const newPassword = document.getElementById("newPassword").value.trim();
        const confirmNewPassword = document
          .getElementById("confirmNewPassword")
          .value.trim();

        if (newPassword.length < 6) {
          message.textContent = "Password must be at least 6 characters.";
          return;
        }

        if (newPassword !== confirmNewPassword) {
          message.textContent = "Passwords do not match.";
          return;
        }

        alert("Password changed successfully! (simulated)");
        window.location.href = "login.html";
      });
    </script>
  </body>
</html>
